function doStuff(a,b,c){var d=b.split(","),e=c.split(","),f="",g="",h=0,i=0,j="",k="";$.each(d,function(a){a<3?a+1==d.length||a+1==3?g+=d[a]:g+=d[a]+", ":(h++,a+1==d.length?j+=d[a]:j+=d[a]+", ")}),$.each(e,function(a){a<3?a+1==e.length||a+1==3?f+=e[a]:f+=e[a]+", ":(i++,a+1==hate.length?k+=e[a]:k+=e[a]+", ")}),j.length!=0&&(g=g+' and <abbr title="'+j+'">'+h+" more</abbr>"),k.length!=0&&(f=f+' and <abbr title="'+k+'">'+i+" more</abbr>"),a.parents(".post").find(".opinion .like span").text(g),a.parents(".post").find(".opinion .dislike span").text(f),b.length==0?a.parents(".post").find(".opinion .like").hide():a.parents(".post").find(".opinion .like").show(),c.length==0?a.parents(".post").find(".opinion .dislike").hide():a.parents(".post").find(".opinion .dislike").show()}$().ready(function(){$(".opinion .dislike span").each(function(){$(this).text().trim().length==0&&$(this).parents(".dislike").hide()}),$(".opinion .like span").each(function(){$(this).text().trim().length==0&&$(this).parents(".like").hide()}),$(".options .like span").click(function(){var a=$(this),b=$(this).parents().siblings(".date").children("a").attr("href")+"/like";$.ajax({url:b,success:function(b){switch(b.response){case"removed":a.text("Like"),doStuff(a,b.liked_by,b.hated_by);break;case"liked":a.text("Liked"),a.parents(".options").children(".dislike").children("span").text("Dislike"),doStuff(a,b.liked_by,b.hated_by);break;default:console.log("error")}}})}),$(".options .dislike span").click(function(){var a=$(this),b=$(this).parents().siblings(".date").children("a").attr("href")+"/dislike";$.ajax({url:b,success:function(b){switch(b.response){case"removed":a.text("Dislike"),doStuff(a,b.liked_by,b.hated_by);break;case"disliked":a.text("Disliked"),a.parents(".options").children(".like").children("span").text("Like"),doStuff(a,b.liked_by,b.hated_by);break;default:console.log("error")}}})})});